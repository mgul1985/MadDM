# MadGraph for Dark Matter
>> mkdir madgraph

Install MadGraph with latest version (check it, i am using MG5_aMC_v3.2.0):

>> wget https://launchpad.net/mg5amcnlo/3.0/3.3.x/+download/MG5_aMC_v3.3.1.tar.gz
>> tar xf MG5_aMC_v3.3.1.tar.gz
>> rm MG5_aMC_v3.3.1.tar.gz

Download models from (download the whole repo as you like and copy models in the Madgraph models dir):
https://github.com/LHC-DMWG/model-repository/tree/DMSimp_t
>> git clone https://github.com/LHC-DMWG/model-repository.git

>> Model explanation can be found here:
https://github.com/LHC-DMWG/model-repository/blob/DMSimp_t/models/Pseudoscalar_2HDM/README.txt

Use the PDF set: NNPDF31_lo_as_0118 and nlo, nnlo
download from here:https://lhapdf.hepforge.org/downloads?f=pdfsets/v6.backup/current
Can use the script, but change the version and name of pdfsets:

https://github.com/muhammadgul/schools/blob/master/install_PDF_set.sh

[for lxplus at CERN use it. 
source /cvmfs/sft.cern.ch/lcg/releases/LCG_98python3/Python/3.7.6/x86_64-centos7-gcc10-opt/Python-env.sh]

Update the python3.8 dependency, see the question https://answers.launchpad.net/mg5amcnlo/+question/700490
>> sudo apt update
>> sudo apt install python3.8-dev

Run MGraph:
>> python3.8 ./bin/mg5_aMC

Install LHAPDF:
>> install lhapdf6

include path to the library path from the path/to/HEPTools/lhapdf6_py3/
>> export LD_LIBRARY_PATH=$PWD/lib:$LD_LIBRARY_PATH

Now run MGraph:
For mono-higgs signature:

Model Pseudoscalar_2HDM information is here:
https://github.com/LHC-DMWG/model-repository/blob/master/models/Pseudoscalar_2HDM/README.txt

>> python3.8 ./bin/mg5_aMC
For gluon-gluon fusion:
>> import model Pseudoscalar_2HDM
>> generate g g > h1 xd xd~ [noborn=QCD]

{ if you want to exclude a particle like z from the mediator
>>generate g g > h1 xd xd~ /z [noborn=QCD]}

>> display diagrams (optional for diagrams checking)
>> output template_gg_h1_xdxd

Some packages will be installed, if it give "output template_gg_h1_xdxd", mail to the developer:
1. cuttools  (OPP) [0711.3596]   : will be installed (required)
2. iregi     (TIR) [1405.0301]   : will be installed (required)
3. ninja     (OPP) [1403.1229]   : will be installed (recommended)
4. collier   (TIR) [1604.06792]  : will be installed (recommended)
5. golem     (TIR) [0807.0605]   : do not install

>> exit
Generate events:
>> cd template_gg_h1_xdxd
>> python3.8 ./bin/madevent
>> launch
For decaying the SM higgs h1 (h1 > b b~), then after launch command
madSping = ON
In the madspin_card.dat:
set spinmode = none

Change run_card.dat for lhapdf
nnlo... --> lhapdf
315000 for lhaid

for bottom-bottom~ fusion:
>> import model Pseudoscalar_2HDM-bbMET_5FS
>> generate p p > h1 xd xd~, h1 > b b~
>> output template_pp_h1_xdxd
>> exit

Note: if you see a python with PDF issue like: Failed to access python version of LHAPDF: ... 
then, include in .bashrc file, export LD_LIBRARY_PATH=/path/to/MG5_aMC_v3_2_0/HEPTools/lhapdf6_py3/lib:$LD_LIBRARY_PATH 
